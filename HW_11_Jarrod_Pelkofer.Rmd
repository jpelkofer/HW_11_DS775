---
title: "HW_11_DS775"
author: "Jarrod Pelkofer"
date: "April 2, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 20.1-3e
```{r}

sales <- c(rep(2,4), rep(3,7), rep(4,8), rep(5,5), 6)
set.seed(44)
sales_sim <- sample(sales, 300, replace = TRUE)
mean_sim <- mean(sales_sim)
mean_sim

```

e) The 300 day simulation resulted in an average of 3.613 stoves per day, .067 stoves/day less than the 25 day average.

## 20.6-6
```{r}
simulations <- 1000

purchasePrice <- 1.50
salesPrice <- 2.50
refundPrice <- 0.50

copiesOrdered <- c(50:60)

for(i in 1:length(copiesOrdered)){
  set.seed(101)
  copiesSold <- sample(40:70, simulations, replace = TRUE)
  SalesRevenue <- salesPrice*pmin(copiesOrdered[i],copiesSold)
  PurchasingCost <- purchasePrice*copiesOrdered[i]
  Refund <- refundPrice*pmax(copiesOrdered[i]-copiesSold,0)
  Profit <- SalesRevenue-PurchasingCost+Refund
  avgProfit <- mean(Profit)
  print(paste("Order Quantity:", copiesOrdered[i], "Mean:", avgProfit))
}
```
The average profit it highest at an order quantity of 54.

##HW 20.6-7
```{r}
set.seed(333)
Stocks_year0 <- 5000 * (1 + rnorm(1000, .08, .06))
Stocks_year1 <- (2000 + Stocks_year0) * (1 + rnorm(1000, .08, .06))
Stocks_year2 <- (2000 + Stocks_year1) * (1 + rnorm(1000, .08, .06))
Stocks_year3 <- (2000 + Stocks_year2) * (1 + rnorm(1000, .08, .06))
Stocks_year4 <- (2000 + Stocks_year3) * (1 + rnorm(1000, .08, .06))

Bonds_year0 <- 5000 * (1 + rnorm(1000, .04, .03))
Bonds_year1 <- (2000 + Bonds_year0) * (1 + rnorm(1000, .04, .03))
Bonds_year2 <- (2000 + Bonds_year1) * (1 + rnorm(1000, .04, .03))
Bonds_year3 <- (2000 + Bonds_year2) * (1 + rnorm(1000, .04, .03))
Bonds_year4 <- (2000 + Bonds_year3) * (1 + rnorm(1000, .04, .03))

Savings_year5 <- 4000

College_Fund <- Stocks_year4 + Bonds_year4 + Savings_year5

#a)
avg_College_Fund <- mean(College_Fund)
avg_College_Fund
#b)
sd_College_Fund <- sd(College_Fund)
sd_College_Fund
#c)
prob_35K <- sum(College_Fund >=35000)/length(College_Fund)
prob_35K
#d)
prob_40K <- sum(College_Fund >=40000)/length(College_Fund)
prob_40K
```
a) AVerage college fund at the end of year 5 would be $36,076.34.
b) The standard deviation of the college fund at the end of year 5 would be $1,848.54.
c) There is a probability of 71.5% that the college fund will be at least $35,000.
d) There is a probability of 1.9% that the college fund will be at least $40,000.

##HW 20.6-9
```{r}
library(triangle)
library(tidyverse)

#a)
project_cost <- 5000000
bid_cost <- 50000
RPI_Bid <- 5700000
RPI_Total_Cost <- bid_cost + project_cost
RPI_Profit <- RPI_Bid - RPI_Total_Cost

set.seed(99)
competitor_1 <- rtriangle(1000, a = (project_cost*1.05), b = (project_cost*1.40), c = (project_cost*1.20))
competitor_2 <- rtriangle(1000, a = (project_cost*1.05), b = (project_cost*1.40), c = (project_cost*1.20))
competitor_3 <- rtriangle(1000, a = (project_cost*1.05), b = (project_cost*1.40), c = (project_cost*1.20))
competitor_4 <- rtriangle(1000, a = (project_cost*1.05), b = (project_cost*1.40), c = (project_cost*1.20))

RPI_Bids <- rep(RPI_Bid, 1000)
min_bid <- pmin(RPI_Bids, competitor_1, competitor_2, competitor_3, competitor_4)
prob_RPI_WIN <- sum(min_bid==RPI_Bid)/length(min_bid)

profit <-  double()
for(b in 1:length(min_bid)){
  if(min_bid[b] == RPI_Bid){
    profit <- c(profit, RPI_Profit)
  }else{
    profit <- c(profit, -50000)
  }
}

avg_profit <- mean(profit)


#b)
RPI_Bid <- seq(5300000,6000000, 100000)
avg_profits <- double()
for(b in 1:length(RPI_Bid)){
  profit <-  double()
  RPI_Bids <- rep(RPI_Bid[b], 1000)
  min_bid <- pmin(RPI_Bids, competitor_1, competitor_2, competitor_3, competitor_4)
  for(m in 1:length(min_bid)){
    if(min_bid[m] == RPI_Bid[b]){
      gain <- RPI_Bid[b] - RPI_Total_Cost
      profit <- c(profit, gain)
    }else{
      profit <- c(profit, -50000)
    }
  }
  avg_profits <- c(avg_profits, mean(profit))
}  

parameter_report <- data.frame(RPI_Bid, avg_profits)
parameter_report

#c)
ggplot(parameter_report, aes(RPI_Bid, avg_profits)) +
  geom_line() +
  geom_point()
```